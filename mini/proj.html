<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>College Timetable Generator</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #3b82f6;
            --accent-color: #60a5fa;
            --dark-bg: #1f2937;
            --light-bg: #f5f5f0;
            --sidebar-bg: #e5e7eb;
            --sidebar-text: #374151;
            --timetable-bg: #f5f0e8;
            --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --card-bg: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f0;
            min-height: 100vh;
        }

        /* Login Page Styles */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .login-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            max-width: 450px;
            width: 100%;
        }

        .login-header {
            background: var(--primary-color);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .login-header h1 {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .login-header p {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        .login-body {
            padding: 40px 30px;
        }

        .form-label {
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
        }

        .form-control {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 12px 15px;
            transition: all 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .btn-login {
            background: var(--primary-color);
            border: none;
            border-radius: 10px;
            padding: 12px;
            font-weight: 600;
            color: white;
            width: 100%;
            transition: transform 0.2s;
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
            background: var(--secondary-color);
        }

        .btn-login:active {
            transform: translateY(0);
        }

        .login-options {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .login-option-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .login-option-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .alert-login {
            display: none;
            margin-top: 15px;
            border-radius: 10px;
        }

        /* Dashboard Styles */
        .dashboard-container {
            display: none;
            min-height: 100vh;
        }

        .dashboard-container.active {
            display: block;
        }

        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: 280px;
            background: var(--sidebar-bg);
            color: var(--sidebar-text);
            padding: 20px 0;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            overflow-y: auto;
            border-right: 1px solid #d1d5db;
        }

        .sidebar-header {
            padding: 20px 25px;
            border-bottom: 1px solid #d1d5db;
            margin-bottom: 20px;
        }

        .sidebar-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .sidebar-header p {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        .sidebar-menu {
            list-style: none;
            padding: 0;
        }

        .sidebar-menu li {
            margin: 5px 0;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: var(--sidebar-text);
            text-decoration: none;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary-color);
            border-left-color: var(--primary-color);
        }

        .sidebar-menu a i {
            margin-right: 12px;
            font-size: 1.2rem;
        }

        .main-content {
            margin-left: 280px;
            padding: 30px;
            background: var(--timetable-bg);
            min-height: 100vh;
        }

        .page-header {
            background: var(--card-bg);
            padding: 25px 30px;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #e5e7eb;
        }

        .page-header h2 {
            color: var(--dark-bg);
            font-weight: 600;
            margin: 0;
        }

        .btn-logout {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-logout:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.3);
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .card {
            border: 1px solid #e5e7eb;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
            margin-bottom: 25px;
            background: var(--card-bg);
        }

        .card-header {
            background: var(--primary-color);
            color: white;
            border-radius: 15px 15px 0 0 !important;
            padding: 20px 25px;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .card-body {
            padding: 25px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .btn-primary-custom {
            background: var(--primary-color);
            border: none;
            color: white;
            padding: 12px 30px;
            border-radius: 10px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
            background: var(--secondary-color);
        }

        .btn-danger-custom {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
        }

        .btn-success-custom {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
        }

        .table {
            background: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
        }

        .table thead {
            background: var(--primary-color);
            color: white;
        }

        .table thead th {
            border: none;
            padding: 15px;
            font-weight: 600;
        }

        .table tbody td {
            padding: 15px;
            vertical-align: middle;
        }

        .badge-custom {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 500;
        }

        .notification-item {
            background: var(--card-bg);
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary-color);
            box-shadow: var(--card-shadow);
            border: 1px solid #e5e7eb;
        }

        .notification-item.new {
            border-left-color: #10b981;
            background: #f0fdf4;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }

            .main-content {
                margin-left: 0;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Login Container -->
    <div id="loginContainer" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <h1><i class="bi bi-calendar-week"></i> Timetable Generator</h1>
                <p>College Management System</p>
            </div>
            <div class="login-body">
                <div class="login-options">
                    <button class="login-option-btn active" onclick="switchLoginType('admin')">
                        <i class="bi bi-person-badge"></i> Admin
                    </button>
                    <button class="login-option-btn" onclick="switchLoginType('student')">
                        <i class="bi bi-person"></i> Student
                    </button>
                </div>
                <form id="loginForm" onsubmit="handleLogin(event)">
                    <div class="mb-3">
                        <label class="form-label">Username</label>
                        <input type="text" class="form-control" id="username" placeholder="Enter username" required>
                    </div>
                    <div class="mb-4">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" placeholder="Enter password" required>
                    </div>
                    <button type="submit" class="btn btn-login" id="loginBtn">
                        <i class="bi bi-box-arrow-in-right"></i> Login
                    </button>
                    <div class="alert alert-login alert-success mt-3" id="loginAlert" role="alert"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="dashboard-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h3><i class="bi bi-shield-check"></i> Admin Panel</h3>
                <p>Full Access</p>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="active" onclick="showSection('admin-dashboard')"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
                <li><a href="#" onclick="showSection('admin-timetable')"><i class="bi bi-calendar-week"></i> Manage Timetable</a></li>
                <li><a href="#" onclick="showSection('admin-generate')"><i class="bi bi-magic"></i> Generate Timetable</a></li>
                <li><a href="#" onclick="showSection('admin-reports')"><i class="bi bi-exclamation-triangle"></i> Issue Reports</a></li>
                <li><a href="#" onclick="logout()"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
            </ul>
        </div>
        <div class="main-content">
            <div class="page-header">
                <h2 id="adminPageTitle">Admin Dashboard</h2>
                <button class="btn btn-logout" onclick="logout()"><i class="bi bi-box-arrow-right"></i> Logout</button>
            </div>

            <!-- Admin Dashboard Section -->
            <div id="admin-dashboard" class="content-section active">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <i class="bi bi-calendar-check" style="font-size: 3rem; color: var(--primary-color);"></i>
                                <h4 class="mt-3">Total Timetables</h4>
                                <h2 id="adminTotalTimetables">0</h2>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <i class="bi bi-people" style="font-size: 3rem; color: var(--secondary-color);"></i>
                                <h4 class="mt-3">Departments</h4>
                                <h2 id="adminTotalDepartments">0</h2>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <i class="bi bi-book" style="font-size: 3rem; color: var(--accent-color);"></i>
                                <h4 class="mt-3">Subjects</h4>
                                <h2 id="adminTotalSubjects">0</h2>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Manage Timetable Section -->
            <div id="admin-timetable" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <i class="bi bi-plus-circle"></i> Add New Timetable Entry
                    </div>
                    <div class="card-body">
                        <form id="adminTimetableForm" onsubmit="addTimetableEntry(event)">
                            <div class="form-row">
                                <div>
                                    <label class="form-label">Department</label>
                                    <select class="form-control" id="adminDepartment" required>
                                        <option value="">Select Department</option>
                                        <option value="MCA">MCA</option>
                                        <option value="MBA">MBA</option>
                                        <option value="MSc.Psychology">MSc.Psychology</option>
                                        <option value="MA Economics">MA Economics</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label">Semester</label>
                                    <select class="form-control" id="adminSemester" required>
                                        <option value="">Select Semester</option>
                                        <option value="1">Semester 1</option>
                                        <option value="2">Semester 2</option>
                                        <option value="3">Semester 3</option>
                                        <option value="4">Semester 4</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label">Day</label>
                                    <select class="form-control" id="adminDay" required>
                                        <option value="">Select Day</option>
                                        <option value="Monday">Monday</option>
                                        <option value="Tuesday">Tuesday</option>
                                        <option value="Wednesday">Wednesday</option>
                                        <option value="Thursday">Thursday</option>
                                        <option value="Friday">Friday</option>
                                        <option value="Saturday">Saturday</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label">Time Slot</label>
                                    <select class="form-control" id="adminTimeSlot" required>
                                        <option value="">Select Time Slot</option>
                                        <option value="9:00 AM - 10:00 AM">9:00 AM - 10:00 AM</option>
                                        <option value="10:00 AM - 11:00 AM">10:00 AM - 11:00 AM</option>
                                        <option value="11:00 AM - 12:00 PM">11:00 AM - 12:00 PM</option>
                                        <option value="12:00 PM - 1:00 PM">12:00 PM - 1:00 PM</option>
                                        <option value="1:00 PM - 2:00 PM">1:00 PM - 2:00 PM</option>
                                        <option value="2:00 PM - 3:00 PM">2:00 PM - 3:00 PM</option>
                                        <option value="3:00 PM - 4:00 PM">3:00 PM - 4:00 PM</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label">Subject</label>
                                    <input type="text" class="form-control" id="adminSubject" placeholder="Enter subject name" required>
                                </div>
                                <div>
                                    <label class="form-label">Faculty</label>
                                    <input type="text" class="form-control" id="adminFaculty" placeholder="Enter faculty name" required>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary-custom">
                                <i class="bi bi-plus-circle"></i> Add Entry
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <i class="bi bi-table"></i> Timetable Entries
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Department</th>
                                        <th>Semester</th>
                                        <th>Day</th>
                                        <th>Time Slot</th>
                                        <th>Subject</th>
                                        <th>Faculty</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="adminTimetableTable">
                                    <tr>
                                        <td colspan="7" class="text-center">
                                            <div class="empty-state">
                                                <i class="bi bi-inbox"></i>
                                                <p>No timetable entries yet. Add your first entry above.</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Generate Timetable Section -->
            <div id="admin-generate" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <i class="bi bi-magic"></i> Generate Timetable
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div>
                                <label class="form-label">Select Department</label>
                                <select class="form-control" id="generateDepartment">
                                    <option value="">All Departments</option>
                                    <option value="MCA">MCA</option>
                                    <option value="MBA">MBA</option>
                                    <option value="MSc.Psychology">MSc.Psychology</option>
                                    <option value="MA Economics">MA Economics</option>
                                </select>
                            </div>
                            <div>
                                <label class="form-label">Select Semester</label>
                                <select class="form-control" id="generateSemester">
                                    <option value="">All Semesters</option>
                                    <option value="1">Semester 1</option>
                                    <option value="2">Semester 2</option>
                                    <option value="3">Semester 3</option>
                                    <option value="4">Semester 4</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary-custom" onclick="generateTimetable()">
                            <i class="bi bi-magic"></i> Generate Timetable
                        </button>
                        <div id="generatedTimetable" class="mt-4"></div>
                    </div>
                </div>
            </div>

            <!-- Admin Issue Reports Section -->
            <div id="admin-reports" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <i class="bi bi-exclamation-triangle"></i> Issue Reports from Students
                    </div>
                    <div class="card-body">
                        <div id="adminReportsList">
                            <div class="empty-state">
                                <i class="bi bi-inbox"></i>
                                <p>No issue reports yet.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div id="studentDashboard" class="dashboard-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h3><i class="bi bi-person-circle"></i> Student Panel</h3>
                <p>Limited Access</p>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="active" onclick="showStudentSection('student-dashboard')"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
                <li><a href="#" onclick="showStudentSection('student-view')"><i class="bi bi-calendar-week"></i> View Timetable</a></li>
                <li><a href="#" onclick="showStudentSection('student-notifications')"><i class="bi bi-bell"></i> Notifications</a></li>
                <li><a href="#" onclick="showStudentSection('student-report')"><i class="bi bi-exclamation-triangle"></i> Report Issues</a></li>
                <li><a href="#" onclick="logout()"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
            </ul>
        </div>
        <div class="main-content">
            <div class="page-header">
                <h2 id="studentPageTitle">Student Dashboard</h2>
                <button class="btn btn-logout" onclick="logout()"><i class="bi bi-box-arrow-right"></i> Logout</button>
            </div>

            <!-- Student Dashboard Section -->
            <div id="student-dashboard" class="content-section active">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body text-center">
                                <i class="bi bi-calendar-check" style="font-size: 3rem; color: var(--primary-color);"></i>
                                <h4 class="mt-3">My Timetable</h4>
                                <p class="text-muted">View and download your timetable</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body text-center">
                                <i class="bi bi-bell" style="font-size: 3rem; color: var(--secondary-color);"></i>
                                <h4 class="mt-3">Notifications</h4>
                                <p class="text-muted">Stay updated with changes</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Student View Timetable Section -->
            <div id="student-view" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <i class="bi bi-calendar-week"></i> View Timetable
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div>
                                <label class="form-label">Select Department</label>
                                <select class="form-control" id="studentDepartment" onchange="filterStudentTimetable()">
                                    <option value="">Select Department</option>
                                    <option value="MCA">MCA</option>
                                    <option value="MBA">MBA</option>
                                    <option value="MSc.Psychology">MSc.Psychology</option>
                                    <option value="MA Economics">MA Economics</option>
                                </select>
                            </div>
                            <div>
                                <label class="form-label">Select Semester</label>
                                <select class="form-control" id="studentSemester" onchange="filterStudentTimetable()">
                                    <option value="">Select Semester</option>
                                    <option value="1">Semester 1</option>
                                    <option value="2">Semester 2</option>
                                    <option value="3">Semester 3</option>
                                    <option value="4">Semester 4</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-success-custom" onclick="downloadTimetable()">
                                <i class="bi bi-download"></i> Download Timetable
                            </button>
                        </div>
                        <div id="studentTimetableDisplay" class="mt-4">
                            <div class="empty-state">
                                <i class="bi bi-calendar-x"></i>
                                <p>Please select department and semester to view timetable.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Student Notifications Section -->
            <div id="student-notifications" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <i class="bi bi-bell"></i> Notifications
                    </div>
                    <div class="card-body">
                        <div id="studentNotificationsList">
                            <div class="empty-state">
                                <i class="bi bi-bell-slash"></i>
                                <p>No notifications yet.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Student Report Issues Section -->
            <div id="student-report" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <i class="bi bi-exclamation-triangle"></i> Report Issues
                    </div>
                    <div class="card-body">
                        <form id="reportIssueForm" onsubmit="submitIssueReport(event)">
                            <div class="mb-3">
                                <label class="form-label">Issue Type</label>
                                <select class="form-control" id="issueType" required>
                                    <option value="">Select Issue Type</option>
                                    <option value="timetable">Timetable Error</option>
                                    <option value="subject">Subject Issue</option>
                                    <option value="faculty">Faculty Issue</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" id="issueDescription" rows="5" placeholder="Describe your issue in detail..." required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary-custom">
                                <i class="bi bi-send"></i> Submit Report
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Global Variables
        let currentUserType = 'admin';
        let timetableEntries = JSON.parse(localStorage.getItem('timetableEntries')) || [];
        let issueReports = JSON.parse(localStorage.getItem('issueReports')) || [];
        let notifications = JSON.parse(localStorage.getItem('notifications')) || [];

        // Login Functions
        function switchLoginType(type) {
            currentUserType = type;
            const buttons = document.querySelectorAll('.login-option-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.closest('.login-option-btn').classList.add('active');
        }

        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const loginBtn = document.getElementById('loginBtn');
            const loginAlert = document.getElementById('loginAlert');

            // Disable button and show verifying
            loginBtn.disabled = true;
            loginBtn.innerHTML = '<i class="bi bi-hourglass-split"></i> Verifying Credentials...';
            loginAlert.style.display = 'none';

            // Simulate verification delay
            setTimeout(() => {
                loginAlert.style.display = 'block';
                loginAlert.className = 'alert alert-login alert-success';
                loginAlert.innerHTML = '<i class="bi bi-check-circle"></i> Login Successful! Redirecting...';
                
                setTimeout(() => {
                    document.getElementById('loginContainer').style.display = 'none';
                    if (currentUserType === 'admin') {
                        document.getElementById('adminDashboard').classList.add('active');
                        updateAdminDashboard();
                        showSection('admin-dashboard');
                    } else {
                        document.getElementById('studentDashboard').classList.add('active');
                        showStudentSection('student-dashboard');
                    }
                    loginBtn.disabled = false;
                    loginBtn.innerHTML = '<i class="bi bi-box-arrow-in-right"></i> Login';
                    document.getElementById('loginForm').reset();
                }, 1000);
            }, 1500);
        }

        // Admin Functions
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Update active menu
            document.querySelectorAll('.sidebar-menu a').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update page title
            const titles = {
                'admin-dashboard': 'Admin Dashboard',
                'admin-timetable': 'Manage Timetable',
                'admin-generate': 'Generate Timetable',
                'admin-reports': 'Issue Reports'
            };
            document.getElementById('adminPageTitle').textContent = titles[sectionId] || 'Admin Dashboard';
            
            // Refresh data if needed
            if (sectionId === 'admin-timetable') {
                displayTimetableEntries();
            } else if (sectionId === 'admin-reports') {
                displayAdminReports();
            }
        }

        function addTimetableEntry(event) {
            event.preventDefault();
            
            const entry = {
                id: Date.now(),
                department: document.getElementById('adminDepartment').value,
                semester: document.getElementById('adminSemester').value,
                day: document.getElementById('adminDay').value,
                timeSlot: document.getElementById('adminTimeSlot').value,
                subject: document.getElementById('adminSubject').value,
                faculty: document.getElementById('adminFaculty').value
            };
            
            timetableEntries.push(entry);
            localStorage.setItem('timetableEntries', JSON.stringify(timetableEntries));
            
            // Create notification for students
            const notification = {
                id: Date.now(),
                type: 'added',
                title: 'New Timetable Entry Added',
                message: `${entry.subject} has been added to ${entry.department} - Semester ${entry.semester} on ${entry.day} (${entry.timeSlot})`,
                department: entry.department,
                semester: entry.semester,
                date: new Date().toLocaleString(),
                isNew: true
            };
            notifications.unshift(notification);
            localStorage.setItem('notifications', JSON.stringify(notifications));
            
            document.getElementById('adminTimetableForm').reset();
            displayTimetableEntries();
            updateAdminDashboard();
            
            alert('Timetable entry added successfully!');
        }

        function deleteTimetableEntry(id) {
            if (confirm('Are you sure you want to delete this entry?')) {
                const entryToDelete = timetableEntries.find(e => e.id === id);
                timetableEntries = timetableEntries.filter(entry => entry.id !== id);
                localStorage.setItem('timetableEntries', JSON.stringify(timetableEntries));
                
                // Create notification for students
                if (entryToDelete) {
                    const notification = {
                        id: Date.now(),
                        type: 'deleted',
                        title: 'Timetable Entry Removed',
                        message: `${entryToDelete.subject} has been removed from ${entryToDelete.department} - Semester ${entryToDelete.semester} on ${entryToDelete.day} (${entryToDelete.timeSlot})`,
                        department: entryToDelete.department,
                        semester: entryToDelete.semester,
                        date: new Date().toLocaleString(),
                        isNew: true
                    };
                    notifications.unshift(notification);
                    localStorage.setItem('notifications', JSON.stringify(notifications));
                }
                
                displayTimetableEntries();
                updateAdminDashboard();
            }
        }

        function displayTimetableEntries() {
            const tableBody = document.getElementById('adminTimetableTable');
            
            if (timetableEntries.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center">
                            <div class="empty-state">
                                <i class="bi bi-inbox"></i>
                                <p>No timetable entries yet. Add your first entry above.</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tableBody.innerHTML = timetableEntries.map(entry => `
                <tr>
                    <td>${entry.department}</td>
                    <td>Semester ${entry.semester}</td>
                    <td>${entry.day}</td>
                    <td>${entry.timeSlot}</td>
                    <td>${entry.subject}</td>
                    <td>${entry.faculty}</td>
                    <td>
                        <button class="btn btn-danger-custom btn-sm" onclick="deleteTimetableEntry(${entry.id})">
                            <i class="bi bi-trash"></i> Delete
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function generateTimetable() {
            const dept = document.getElementById('generateDepartment').value;
            const sem = document.getElementById('generateSemester').value;
            
            let filtered = timetableEntries;
            if (dept) filtered = filtered.filter(e => e.department === dept);
            if (sem) filtered = filtered.filter(e => e.semester === sem);
            
            if (filtered.length === 0) {
                document.getElementById('generatedTimetable').innerHTML = `
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle"></i> No entries found for the selected criteria.
                    </div>
                `;
                return;
            }
            
            // Group by day
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            let html = '<div class="table-responsive"><table class="table"><thead><tr><th>Time Slot</th>';
            days.forEach(day => {
                html += `<th>${day}</th>`;
            });
            html += '</tr></thead><tbody>';
            
            const timeSlots = [...new Set(filtered.map(e => e.timeSlot))].sort();
            timeSlots.forEach(timeSlot => {
                html += `<tr><td><strong>${timeSlot}</strong></td>`;
                days.forEach(day => {
                    const entry = filtered.find(e => e.day === day && e.timeSlot === timeSlot);
                    if (entry) {
                        html += `<td><strong>${entry.subject}</strong><br><small>${entry.faculty}</small></td>`;
                    } else {
                        html += '<td>-</td>';
                    }
                });
                html += '</tr>';
            });
            html += '</tbody></table></div>';
            
            document.getElementById('generatedTimetable').innerHTML = html;
        }

        function updateAdminDashboard() {
            document.getElementById('adminTotalTimetables').textContent = timetableEntries.length;
            const departments = new Set(timetableEntries.map(e => e.department));
            document.getElementById('adminTotalDepartments').textContent = departments.size;
            const subjects = new Set(timetableEntries.map(e => e.subject));
            document.getElementById('adminTotalSubjects').textContent = subjects.size;
        }

        // Student Functions
        function showStudentSection(sectionId) {
            document.querySelectorAll('#studentDashboard .content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('#studentDashboard .sidebar-menu a').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');
            
            const titles = {
                'student-dashboard': 'Student Dashboard',
                'student-view': 'View Timetable',
                'student-notifications': 'Notifications',
                'student-report': 'Report Issues'
            };
            document.getElementById('studentPageTitle').textContent = titles[sectionId] || 'Student Dashboard';
            
            // Refresh data if needed
            if (sectionId === 'student-notifications') {
                displayStudentNotifications();
            }
        }

        function filterStudentTimetable() {
            const dept = document.getElementById('studentDepartment').value;
            const sem = document.getElementById('studentSemester').value;
            
            if (!dept || !sem) {
                document.getElementById('studentTimetableDisplay').innerHTML = `
                    <div class="empty-state">
                        <i class="bi bi-calendar-x"></i>
                        <p>Please select department and semester to view timetable.</p>
                    </div>
                `;
                return;
            }
            
            let filtered = timetableEntries.filter(e => e.department === dept && e.semester === sem);
            
            if (filtered.length === 0) {
                document.getElementById('studentTimetableDisplay').innerHTML = `
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i> No timetable found for the selected criteria.
                    </div>
                `;
                return;
            }
            
            // Generate timetable view
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            let html = '<div class="table-responsive"><table class="table"><thead><tr><th>Time Slot</th>';
            days.forEach(day => {
                html += `<th>${day}</th>`;
            });
            html += '</tr></thead><tbody>';
            
            const timeSlots = [...new Set(filtered.map(e => e.timeSlot))].sort();
            timeSlots.forEach(timeSlot => {
                html += `<tr><td><strong>${timeSlot}</strong></td>`;
                days.forEach(day => {
                    const entry = filtered.find(e => e.day === day && e.timeSlot === timeSlot);
                    if (entry) {
                        html += `<td><strong>${entry.subject}</strong><br><small>${entry.faculty}</small></td>`;
                    } else {
                        html += '<td>-</td>';
                    }
                });
                html += '</tr>';
            });
            html += '</tbody></table></div>';
            
            document.getElementById('studentTimetableDisplay').innerHTML = html;
        }

        function downloadTimetable() {
            const dept = document.getElementById('studentDepartment').value;
            const sem = document.getElementById('studentSemester').value;
            
            if (!dept || !sem) {
                alert('Please select department and semester first.');
                return;
            }
            
            alert('Timetable download functionality will be implemented with backend integration.');
        }

        function submitIssueReport(event) {
            event.preventDefault();
            
            const report = {
                id: Date.now(),
                type: document.getElementById('issueType').value,
                description: document.getElementById('issueDescription').value,
                date: new Date().toLocaleString(),
                status: 'pending'
            };
            
            issueReports.push(report);
            localStorage.setItem('issueReports', JSON.stringify(issueReports));
            
            document.getElementById('reportIssueForm').reset();
            alert('Issue reported successfully! Thank you for your feedback.');
        }

        // Display Admin Reports
        function displayAdminReports() {
            const reportsList = document.getElementById('adminReportsList');
            
            // Reload reports from localStorage
            issueReports = JSON.parse(localStorage.getItem('issueReports')) || [];
            
            if (issueReports.length === 0) {
                reportsList.innerHTML = `
                    <div class="empty-state">
                        <i class="bi bi-inbox"></i>
                        <p>No issue reports yet.</p>
                    </div>
                `;
                return;
            }
            
            // Sort by date (newest first)
            const sortedReports = [...issueReports].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            reportsList.innerHTML = sortedReports.map(report => {
                const typeLabels = {
                    'timetable': 'Timetable Error',
                    'subject': 'Subject Issue',
                    'faculty': 'Faculty Issue',
                    'other': 'Other'
                };
                const statusBadge = report.status === 'pending' 
                    ? '<span class="badge bg-warning">Pending</span>'
                    : '<span class="badge bg-success">Resolved</span>';
                
                return `
                    <div class="notification-item ${report.status === 'pending' ? 'new' : ''}">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <div>
                                <h6><i class="bi bi-exclamation-triangle-fill text-danger"></i> ${typeLabels[report.type] || report.type}</h6>
                                <small class="text-muted">Reported on: ${report.date}</small>
                            </div>
                            ${statusBadge}
                        </div>
                        <p class="mb-0">${report.description}</p>
                    </div>
                `;
            }).join('');
        }

        // Display Student Notifications
        function displayStudentNotifications() {
            const notificationsList = document.getElementById('studentNotificationsList');
            
            // Reload notifications from localStorage
            notifications = JSON.parse(localStorage.getItem('notifications')) || [];
            
            if (notifications.length === 0) {
                notificationsList.innerHTML = `
                    <div class="empty-state">
                        <i class="bi bi-bell-slash"></i>
                        <p>No notifications yet.</p>
                    </div>
                `;
                return;
            }
            
            // Sort by date (newest first) and limit to last 20
            const sortedNotifications = [...notifications]
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 20);
            
            notificationsList.innerHTML = sortedNotifications.map(notif => {
                const iconClass = notif.type === 'added' 
                    ? 'bi-check-circle-fill text-success' 
                    : 'bi-x-circle-fill text-danger';
                const isNew = notif.isNew ? 'new' : '';
                
                return `
                    <div class="notification-item ${isNew}">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6><i class="bi ${iconClass}"></i> ${notif.title}</h6>
                                <p class="mb-0 text-muted">${notif.message}</p>
                                <small class="text-muted">${notif.date}</small>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Mark all as read after displaying
            notifications.forEach(n => n.isNew = false);
            localStorage.setItem('notifications', JSON.stringify(notifications));
        }

        // Logout Function
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                document.getElementById('adminDashboard').classList.remove('active');
                document.getElementById('studentDashboard').classList.remove('active');
                document.getElementById('loginContainer').style.display = 'flex';
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                // Reset login button state
                const loginBtn = document.getElementById('loginBtn');
                loginBtn.disabled = false;
                loginBtn.innerHTML = '<i class="bi bi-box-arrow-in-right"></i> Login';
                const loginAlert = document.getElementById('loginAlert');
                loginAlert.style.display = 'none';
                loginAlert.innerHTML = '';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateAdminDashboard();
            displayTimetableEntries();
            displayStudentNotifications();
        });
    </script>
</body>
</html>